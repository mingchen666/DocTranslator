import{_ as ae}from"./nodata-CSuNOf8O.js";import{F as ie}from"./filing-I4Qy6mwB.js";import{_ as te,r as y,p as c,o as p,c as b,g as l,w as o,a as s,t as I,i as g,F as j,m as A,k as S,E as d,f as ue,l as de,j as W,H as ce,N as pe,O as ee,P as me,Q as _e,R as fe,S as ge,q as ve,v as se,h as be,n as ne,T as ye,U as he,V as xe,W as we}from"./index-w8EL8sBS.js";const ke={class:"flag_tips"},Ve={class:"term_custom flex_box flex-between"},Ce={class:"button_box"},$e={class:"term_set_li flex_box flex-between"},Ue={class:"form"},qe=["onClick"],Ne={class:"btn_box"},Ee={class:"btn_box"},Re={__name:"TermEdit",props:{langs:Array,loading:Boolean},emits:["confirm"],setup(D,{expose:z,emit:w}){const R=y(null),C=y(!1),k=y({textarea:""}),v=(h,a,q)=>{R.value.clearValidate(["origin_lang","target_lang"]),r.value.origin_lang!=""&&r.value.target_lang!=""&&r.value.origin_lang==r.value.target_lang?q(new Error("源语种与对照语种不能一样")):q()},m={title:[{required:!0,message:"请填写术语标题",trigger:["blur","change"]}],origin_lang:[{required:!0,message:"请选择源语种",trigger:["blur","change"]},{validator:v,trigger:["blur","change"]}],target_lang:[{required:!0,message:"请选择对照语种",trigger:["blur","change"]},{validator:v,trigger:["blur","change"]}],origin:[{required:!0,message:"请填写源语种内容",trigger:["blur","change"]}],target:[{required:!0,message:"请填写目标语种内容",trigger:["blur","change"]}],textarea:[{required:!0,message:"请填写相应内容",trigger:["blur","change"]}]},f=D,$=y(!1),r=y({content:[{origin:"示例源语种",target:"示例目标语种"}],title:"",share_flag:"N",origin_lang:"",target_lang:""}),Y=w,T=()=>{$.value=!0},_=()=>{$.value=!1},M=()=>{R.value.validate(h=>{h&&(Y("confirm",r.value),_())})},F=y(null);function B(){C.value=!0}function P(){F.value.validate((h,a)=>{if(h){const q=k.value.textarea.trim().split(`
`),N=[];for(const V of q){const t=V.split(",").map(e=>e.trim());if(t.length===2&&t.every(e=>e!==""))N.push({origin:t[0],target:t[1]});else{d({message:"第 "+(q.indexOf(V)+1)+" 行格式有误，无法快速添加！",type:"error"});return}}r.value.content.push(...N),C.value=!1}})}function Q(){r.value.content.push({origin:"",target:""})}function H(h){if(r.value.content.length<=1)return d({message:"至少保留一组！",type:"error"}),!1;r.value.content.splice(h,1)}function J(h){(!h.content||h.content.length===0)&&(h.content=[{origin:"",target:""}]),r.value=h}return z({open:T,close:_,updateForm:J,localForm:r}),(h,a)=>{const q=c("el-switch"),N=c("el-input"),V=c("el-form-item"),t=c("el-col"),e=c("el-option"),n=c("el-select"),x=c("el-button"),E=c("el-row"),X=c("el-form"),G=c("el-dialog");return p(),b(j,null,[l(G,{modelValue:$.value,"onUpdate:modelValue":a[4]||(a[4]=i=>$.value=i),"destroy-on-close":"",title:"术语编辑器",width:"90%","modal-class":"term_dialog"},{header:o(({close:i,titleId:O,titleClass:L})=>[a[9]||(a[9]=s("span",{class:"title"},"术语编辑器",-1)),l(q,{modelValue:r.value.share_flag,"onUpdate:modelValue":a[0]||(a[0]=Z=>r.value.share_flag=Z),"active-value":"Y","inactive-value":"N"},null,8,["modelValue"]),s("div",ke,"分享"+I(r.value.share_flag=="Y"?"开启":"关闭"),1)]),footer:o(()=>[s("div",Ne,[l(x,{disabled:f.loading,onClick:_},{default:o(()=>a[12]||(a[12]=[g("取消")])),_:1},8,["disabled"]),l(x,{type:"primary",color:"#055CF9",disabled:f.loading,props:f.loading,onClick:M},{default:o(()=>a[13]||(a[13]=[g(" 保存 ")])),_:1},8,["disabled","props"])])]),default:o(()=>[l(X,{ref_key:"termformRef",ref:R,model:r.value,rules:m,"label-position":"top","hide-required-asterisk":"true"},{default:o(()=>[l(E,{gutter:20},{default:o(()=>[l(t,{span:24},{default:o(()=>[l(V,{label:"术语表标题",required:"",prop:"title",width:"100%"},{default:o(()=>[l(N,{modelValue:r.value.title,"onUpdate:modelValue":a[1]||(a[1]=i=>r.value.title=i),type:"text",placeholder:"请输入术语表标题",maxlength:"50"},null,8,["modelValue"])]),_:1})]),_:1}),l(t,{xs:24,sm:12},{default:o(()=>[l(V,{label:"源语种",required:"",prop:"origin_lang",width:"100%"},{default:o(()=>[l(n,{modelValue:r.value.origin_lang,"onUpdate:modelValue":a[2]||(a[2]=i=>r.value.origin_lang=i),placeholder:"请选择",clearable:""},{default:o(()=>[(p(!0),b(j,null,A(f.langs,i=>(p(),S(e,{key:i,name:i,value:i},null,8,["name","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),l(t,{xs:24,sm:12},{default:o(()=>[l(V,{label:"对照语种",required:"",prop:"target_lang",width:"100%"},{default:o(()=>[l(n,{modelValue:r.value.target_lang,"onUpdate:modelValue":a[3]||(a[3]=i=>r.value.target_lang=i),placeholder:"请选择",clearable:""},{default:o(()=>[(p(!0),b(j,null,A(f.langs,i=>(p(),S(e,{key:i,name:i,value:i},null,8,["name","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),l(t,{xs:24},{default:o(()=>[s("div",Ve,[a[11]||(a[11]=s("div",{class:"label"},"术语",-1)),s("div",Ce,[l(x,{type:"text",onClick:B},{default:o(()=>a[10]||(a[10]=[g("快速编辑")])),_:1}),s("div",{class:"icon_add",onClick:Q},"+")])])]),_:1}),(p(!0),b(j,null,A(r.value.content,(i,O)=>(p(),S(t,{span:24,key:O},{default:o(()=>[s("div",$e,[s("div",Ue,[l(E,{gutter:20},{default:o(()=>[l(t,{xs:24,sm:12},{default:o(()=>[l(V,{label:"",required:"",prop:"content."+O+".origin",rules:m.origin,width:"100%"},{default:o(()=>[l(N,{modelValue:i.origin,"onUpdate:modelValue":L=>i.origin=L,type:"text",maxlength:"512"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["prop","rules"])]),_:2},1024),l(t,{xs:24,sm:12},{default:o(()=>[l(V,{label:"",required:"",prop:"content."+O+".target",rules:m.target,width:"100%"},{default:o(()=>[l(N,{modelValue:i.target,"onUpdate:modelValue":L=>i.target=L,type:"text",maxlength:"512"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["prop","rules"])]),_:2},1024)]),_:2},1024)]),s("div",{class:"icon_del",onClick:L=>H(O)},"-",8,qe)])]),_:2},1024))),128))]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"]),l(G,{modelValue:C.value,"onUpdate:modelValue":a[8]||(a[8]=i=>C.value=i),title:"快速编辑器",width:"90%","modal-class":"term_dialog"},{default:o(()=>[a[16]||(a[16]=s("div",{class:"tips"}," 一行一个，请输入源语种和目标语种，中间用英文逗号隔开，示例：易和网,EHEWON ",-1)),l(X,{ref_key:"quickFormRef",ref:F,model:k.value,rules:m,"label-position":"top","hide-required-asterisk":"true"},{default:o(()=>[l(V,{label:"",required:"",prop:"textarea",width:"100%"},{default:o(()=>[l(N,{modelValue:k.value.textarea,"onUpdate:modelValue":a[5]||(a[5]=i=>k.value.textarea=i),type:"textarea",rows:"10",resize:"none",placeholder:"请输入"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"]),s("div",Ee,[l(x,{onClick:a[6]||(a[6]=i=>C.value=!1)},{default:o(()=>a[14]||(a[14]=[g("取消")])),_:1}),l(x,{type:"primary",color:"#055CF9",onClick:a[7]||(a[7]=i=>P(F.value))},{default:o(()=>a[15]||(a[15]=[g("保存")])),_:1})])]),_:1},8,["modelValue"])],64)}}},Fe=te(Re,[["__scopeId","data-v-c0c92b46"]]),Te={class:"flag_tips"},Oe={class:"btn_box"},Le={__name:"PromptEdit",props:{loading:Boolean},emits:["confirm","close"],setup(D,{expose:z,emit:w}){const R={title:[{required:!0,message:"请填写提示语标题",trigger:["blur","change"]}],content:[{required:!0,message:"请填写提示语内容",trigger:["blur","change"]}]},C=w,k=y(null),v=y(!1),m=y({title:"",share_flag:"N",content:""}),f=()=>{v.value=!0},$=()=>{v.value=!1},r=()=>{k.value.validate(T=>{T&&(C("confirm",m.value),$())})};return z({open:f,close:$,updateForm:T=>{m.value=T},localForm:m}),(T,_)=>{const M=c("el-switch"),F=c("el-input"),B=c("el-form-item"),P=c("el-col"),Q=c("el-row"),H=c("el-form"),J=c("el-button"),h=c("el-dialog");return p(),S(h,{modelValue:v.value,"onUpdate:modelValue":_[3]||(_[3]=a=>v.value=a),"destroy-on-close":"",title:"提示语编辑器",width:"90%","modal-class":"term_dialog"},{header:o(({close:a,titleId:q,titleClass:N})=>[_[4]||(_[4]=s("span",{class:"title"},"提示语编辑器",-1)),l(M,{modelValue:m.value.share_flag,"onUpdate:modelValue":_[0]||(_[0]=V=>m.value.share_flag=V),"active-value":"Y","inactive-value":"N"},null,8,["modelValue"]),s("div",Te,"分享"+I(m.value.share_flag=="Y"?"开启":"关闭"),1)]),default:o(()=>[l(H,{ref_key:"promptformRef",ref:k,model:m.value,rules:R,"label-position":"top","hide-required-asterisk":"true"},{default:o(()=>[l(Q,{gutter:20},{default:o(()=>[l(P,{span:24},{default:o(()=>[l(B,{label:"提示语标题",required:"",prop:"title",width:"100%"},{default:o(()=>[l(F,{modelValue:m.value.title,"onUpdate:modelValue":_[1]||(_[1]=a=>m.value.title=a),type:"text",placeholder:"请输入提示语标题",maxlength:"50"},null,8,["modelValue"])]),_:1})]),_:1}),l(P,{span:24},{default:o(()=>[l(B,{label:"提示语内容",required:"",prop:"content",width:"100%"},{default:o(()=>[l(F,{modelValue:m.value.content,"onUpdate:modelValue":_[2]||(_[2]=a=>m.value.content=a),type:"textarea",rows:5,resize:"none",placeholder:"请输入"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model"]),s("div",Oe,[l(J,{disabled:D.loading,onClick:$},{default:o(()=>_[5]||(_[5]=[g("取消")])),_:1},8,["disabled"]),l(J,{type:"primary",color:"#055CF9",disabled:D.loading,loading:D.loading,onClick:r},{default:o(()=>_[6]||(_[6]=[g(" 保存 ")])),_:1},8,["disabled","loading"])])]),_:1},8,["modelValue"])}}},Se=te(Le,[["__scopeId","data-v-72a87fe6"]]),Ye={class:"page-center","element-loading-text":"loading...","element-loading-spinner":"el-icon-loading","element-loading-background":"rgba(255, 255, 255, 0.7)"},Be={class:"container"},Ie={class:"tab_box"},De={key:0,class:"content_box"},Pe={class:"flex_box flex-between phone_box"},Je={key:0,class:"btn_box"},je={key:1,class:"btn_box"},ze={key:0,class:"term_box"},Me={class:"term_li"},Qe={class:"flex_box title_box flex-between"},He=["title"],We={class:"des"},Ae={class:"btn_box flex_box flex-between"},Xe={class:"left"},Ge={class:"right"},Ke={key:0,class:"table_box"},Ze={key:1,class:"no_data"},et={key:1,class:"prompt_box"},tt={class:"term_li"},lt={class:"flex_box title_box flex-between"},ot=["title"],at={key:0,class:"btn_box flex_box flex-between"},st={class:"left"},nt={class:"right"},rt={key:1,class:"btn_box"},it={class:"text_box"},ut={class:"text"},dt={key:1,class:"no_data"},ct={__name:"index",setup(D){const z=y("/api/api/comparison/import"),w=y(!1),R=y([]),C=y([]),k=y(null),v=y(!1),m=y(null),f=y("terms");function $(t){f.value=t}const r=async()=>{w.value=!1;try{const t=await ce();t.code===200&&(R.value=t.data.data)}catch(t){console.error("获取术语表数据失败:",t)}w.value=!1},Y=async()=>{w.value=!1;try{const t=await pe();t.code===200&&(C.value=JSON.parse(JSON.stringify(t.data.data)),ee.prompt&&C.value.unshift({title:"默认提示语(无法删除)",content:ee.prompt,undelete:!0}))}catch(t){console.error("获取提示语数据失败:",t)}w.value=!1},T=["中文","英语","日语","俄语","阿拉伯语","西班牙语"],_=t=>{const e=t;v.value=!0,e.id?me(e.id,e).then(n=>{v.value=!1,n.code==200?(d({message:"保存成功",type:"success"}),m.value.close(),Y()):d({message:n.message,type:"error"})}).catch(n=>{d({message:"接口异常",type:"error"})}):_e(e).then(n=>{v.value=!1,n.code==200?(d({message:"保存成功",type:"success"}),m.value.close(),Y()):d({message:n.message,type:"error"})}).catch(n=>{d({message:"接口异常",type:"error"})}),m.value.close(),v.value=!1},M=t=>{const e=t;v.value=!0,e.id?fe(e.id,e).then(n=>{v.value=!1,n.code==200?(d({message:"保存成功",type:"success"}),k.value.close(),r()):d({message:n.message,type:"error"})}).catch(n=>{d({message:"接口异常",type:"error"})}):ge(e).then(n=>{v.value=!1,n.code==200?(d({message:"保存成功",type:"success"}),k.value.close(),r()):d({message:n.message,type:"error"})}).catch(n=>{d({message:"接口异常",type:"error"})}),k.value.close(),v.value=!1};function F(t){k.value.open(),t?k.value.updateForm(JSON.parse(JSON.stringify(t))):k.value.updateForm({title:"",share_flag:"N",origin_lang:"",target_lang:"",content:[{origin:"",target:""}]})}function B(t){m.value.open(),t?m.value.updateForm(JSON.parse(JSON.stringify(t))):m.value.updateForm({title:"",share_flag:"N",content:""})}function P(t){ne.confirm("确定要删除？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{w.value=!0,ye(t.id).then(e=>{e.code==200?(d({message:"删除成功",type:"success"}),r()):d({message:e.message,type:"error"})})})}function Q(t){w.value=!0,he(t.id,{share_flag:t.share_flag}).then(e=>{w.value=!1,e.code==200?d({message:"操作成功",type:"success"}):(d({message:e.message,type:"error"}),t.share_flag=="Y"?t.share_flag="N":t.share_flag="Y")}).catch(e=>{d({message:"接口异常",type:"error"}),t.share_flag=="Y"?t.share_flag="N":t.share_flag="Y"})}async function H(t){try{const e=await fetch(`/api/api/comparison/export/${t.id}`,{headers:{token:`${localStorage.getItem("token")}`}});if(!e.ok)throw new Error("文件下载失败");const n=await e.blob(),x=window.URL.createObjectURL(n),E=document.createElement("a");E.href=x,E.download=`${t.title}.xlsx`,document.body.appendChild(E),E.click(),document.body.removeChild(E),window.URL.revokeObjectURL(x)}catch(e){console.error("下载失败:",e),d.error("文件下载失败，请稍后重试")}}async function J(){try{const t=await fetch("/api/api/comparison/export/all",{headers:{token:`${localStorage.getItem("token")}`}});if(!t.ok)throw new Error("术语表导出失败");const e=await t.blob(),n=window.URL.createObjectURL(e),x=document.createElement("a");x.href=n,x.download=`all_terms_${new Date().toISOString().slice(0,10)}.zip`,document.body.appendChild(x),x.click(),document.body.removeChild(x),window.URL.revokeObjectURL(n)}catch(t){console.error("导出失败:",t),d.error("术语表导出失败，请稍后重试")}}function h(t){t=="down"&&window.open("/api/api/comparison/template")}function a(t){t.code==200?(d({message:"导入成功",type:"success"}),r()):d({message:data.message,type:"error"})}function q(t){const n=t.name.substring(t.name.lastIndexOf(".")+1)==="xlsx";return n||(d({message:"请上传模板格式的文件",type:"error"}),!1)}function N(t){w.value=!0,t.id&&xe(t.id,{share_flag:t.share_flag}).then(e=>{w.value=!1,e.code==200?d({message:"操作成功",type:"success"}):(d({message:e.message,type:"error"}),t.share_flag=="Y"?t.share_flag="N":t.share_flag="Y")}).catch(e=>{d({message:"接口异常",type:"error"}),t.share_flag=="Y"?t.share_flag="N":t.share_flag="Y"})}function V(t){ne.confirm("确定要删除？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{w.value=!0,we(t.id).then(e=>{e.code==200?(d({message:"删除成功",type:"success"}),Y()):d({message:e.message,type:"error"})})})}return ue(()=>{r(),Y()}),(t,e)=>{const n=c("el-button"),x=c("el-button-group"),E=c("el-upload"),X=c("el-dropdown-item"),G=c("el-dropdown-menu"),i=c("el-dropdown"),O=c("el-switch"),L=c("el-table-column"),Z=c("el-table"),le=c("el-col"),oe=c("el-row"),re=ve("loading");return de((p(),b("div",Ye,[s("div",Be,[s("div",Ie,[e[3]||(e[3]=s("div",{class:"tab_li actived"},"我的",-1)),s("div",{class:"tab_li",onClick:e[0]||(e[0]=u=>t.$router.push("/corpus/square"))},"广场")]),(p(),b("div",De,[s("div",Pe,[l(x,null,{default:o(()=>[l(n,{class:se(f.value=="terms"?"btn_active":"my_button"),plain:f.value!="terms",type:f.value=="terms"?"primary":"",onClick:e[1]||(e[1]=u=>$("terms"))},{default:o(()=>e[4]||(e[4]=[g(" 我的术语表 ")])),_:1},8,["class","plain","type"]),l(n,{class:se(f.value=="prompt"?"btn_active":"my_button"),plain:f.value!="prompt",type:f.value=="prompt"?"primary":"",onClick:e[2]||(e[2]=u=>$("prompt"))},{default:o(()=>e[5]||(e[5]=[g(" 我的提示语 ")])),_:1},8,["class","plain","type"])]),_:1}),f.value=="terms"?(p(),b("div",Je,[l(n,{type:"primary",color:"#055CF9",onClick:F},{default:o(()=>e[6]||(e[6]=[g("新建")])),_:1}),l(i,{"split-button":"",type:"",style:{margin:"0 12px"},onCommand:h},{dropdown:o(()=>[l(G,null,{default:o(()=>[l(X,{command:"down"},{default:o(()=>e[8]||(e[8]=[g("模板下载")])),_:1})]),_:1})]),default:o(()=>[l(E,{name:"file","before-upload":q,action:z.value,headers:{token:be(ee).token},"show-file-list":!1,"on-success":(u,K,U)=>a(u),class:"blue_color"},{default:o(()=>e[7]||(e[7]=[g(" 导入 ")])),_:1},8,["action","headers","on-success"])]),_:1}),l(n,{type:"",onClick:J},{default:o(()=>e[9]||(e[9]=[g("全部导出")])),_:1})])):W("",!0),f.value=="prompt"?(p(),b("div",je,[l(n,{type:"primary",color:"#055CF9",onClick:B},{default:o(()=>e[10]||(e[10]=[g("新建")])),_:1})])):W("",!0)]),f.value=="terms"?(p(),b("div",ze,[R.value.length>0?(p(),S(oe,{key:0,gutter:24},{default:o(()=>[(p(!0),b(j,null,A(R.value,(u,K)=>(p(),S(le,{xs:24,sm:8,key:K},{default:o(()=>[s("div",Me,[s("div",Qe,[s("div",{class:"t",title:u.title},I(u.title),9,He),s("div",We,I(u.origin_lang)+"-"+I(u.target_lang),1)]),s("div",Ae,[s("div",Xe,[l(n,{type:"text",onClick:U=>F(u)},{default:o(()=>e[11]||(e[11]=[g("编辑")])),_:2},1032,["onClick"]),l(n,{type:"text",style:{color:"red"},onClick:U=>P(u)},{default:o(()=>e[12]||(e[12]=[g("删除")])),_:2},1032,["onClick"]),l(n,{type:"text",onClick:U=>H(u)},{default:o(()=>e[13]||(e[13]=[g("导出")])),_:2},1032,["onClick"])]),s("div",Ge,[l(O,{modelValue:u.share_flag,"onUpdate:modelValue":U=>u.share_flag=U,"active-value":"Y","inactive-value":"N",onChange:U=>Q(u)},null,8,["modelValue","onUpdate:modelValue","onChange"])])]),u.content.length>0?(p(),b("div",Ke,[l(Z,{data:u.content,style:{width:"100%"},"max-height":"340",border:"","header-cell-class-name":"table_title","tooltip-effect":"light"},{default:o(()=>[l(L,{prop:"origin",label:u.origin_lang,"show-overflow-tooltip":""},null,8,["label"]),l(L,{prop:"target",label:u.target_lang,"show-overflow-tooltip":""},null,8,["label"])]),_:2},1032,["data"])])):W("",!0)])]),_:2},1024))),128))]),_:1})):(p(),b("div",Ze,e[14]||(e[14]=[s("img",{src:ae,alt:""},null,-1),s("div",{class:"text"},"暂无数据",-1)])))])):W("",!0),f.value=="prompt"?(p(),b("div",et,[C.value.length>0?(p(),S(oe,{key:0,gutter:24},{default:o(()=>[(p(!0),b(j,null,A(C.value,(u,K)=>(p(),S(le,{xs:24,sm:8,key:K},{default:o(()=>[s("div",tt,[s("div",lt,[s("div",{class:"t",title:u.title},I(u.title),9,ot)]),u.undelete?(p(),b("div",rt)):(p(),b("div",at,[s("div",st,[l(n,{type:"text",onClick:U=>B(u)},{default:o(()=>e[15]||(e[15]=[g("编辑")])),_:2},1032,["onClick"]),l(n,{type:"text",style:{color:"red"},onClick:U=>V(u)},{default:o(()=>e[16]||(e[16]=[g("删除")])),_:2},1032,["onClick"])]),s("div",nt,[l(O,{modelValue:u.share_flag,"onUpdate:modelValue":U=>u.share_flag=U,"active-value":"Y","inactive-value":"N",onChange:U=>N(u)},null,8,["modelValue","onUpdate:modelValue","onChange"])])])),s("div",it,[s("div",ut,I(u.content),1)])])]),_:2},1024))),128))]),_:1})):(p(),b("div",dt,e[17]||(e[17]=[s("img",{src:ae,alt:""},null,-1),s("div",{class:"text"},"暂无数据",-1)])))])):W("",!0)])),l(ie)]),l(Fe,{ref_key:"termEditRef",ref:k,langs:T,loading:v.value,onConfirm:M},null,8,["loading"]),l(Se,{ref_key:"promptEditRef",ref:m,loading:v.value,onConfirm:_},null,8,["loading"])])),[[re,w.value]])}}},ft=te(ct,[["__scopeId","data-v-5630994c"]]);export{ft as default};
